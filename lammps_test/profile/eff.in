variable	density equal 1e20
log		${density}.spe.log

variable	nepart equal 128
variable	nepart_h equal ${nepart}/2
variable 	V equal ${nepart}/(${density}/1e24)
variable	L equal exp(1.0/3.0*ln(${V}))/2.0

shell mkdir ${density}

units 		real
newton		on
boundary        p p p
processors      1 * *

atom_style	electron

#START INIT SECTION

region          box block -${L} ${L} -${L} ${L} -${L} ${L}
create_box      3 box
create_atoms    1 random ${nepart} 24 box
create_atoms	2 random ${nepart_h} 42 box
create_atoms    3 random ${nepart_h} 41 box

mass            1 1.000794
mass			2 0.000544616997098749
mass            3 0.000544616997098749

set 	type 1 charge 1
set 	type 2 charge -1
set 	type 3 charge -1
set 	type 1 spin/wpmd 0

set     type 2 spin/wpmd 1
set		type 3 spin/wpmd -1
set     type 2 eradius 0.86
set		type 3 eradius 0.86


group ion type 1
group eup type 2
group edown type 3

velocity        ion create 10000 87287 dist gaussian
velocity        eup create 10000 87287 dist gaussian
velocity        edown create 10000 87287 dist gaussian

#END INIT SECTION

pair_style      eff/cut 100 pressure/evirials
pair_coeff 	* *

timestep        0.001

comm_modify	vel yes

compute         energies all pair eff/cut

compute         peratom all stress/atom NULL
compute         p all reduce sum c_peratom[1] c_peratom[2] c_peratom[3]
variable 		etotal_ev equal etotal/627.509474*27.211386

compute         kinetik all ke

variable        mc_eng equal c_energies+c_kinetik
fix             mc all wpmc/awpmd mc_eng 10000 ix ex ew ewp ev

variable        accept equal f_mc[1]
variable        mc_energy equal f_mc[2]
variable        step_energy equal f_mc[3]

fix 			ave all ave/time 100 1 100 c_energies c_kinetik v_accept v_mc_eng file ave_${density}.dat off 1

thermo          1
thermo_modify	norm yes
thermo_style    custom step v_etotal_ev etotal pe ke temp v_accept v_mc_energy v_step_energy

compute		erad all property/atom eradius
compute		sp   all property/atom spin
compute		ch   all property/atom q

dump 		snap all cfg 100 ./${density}/dump.config.*.cfg mass type xs ys zs type x y z vx vy vz c_erad c_sp c_ch
dump_modify snap element I E_UP E_DOWN
run 		10000

unfix ave
unfix mc

thermo_style    custom step etotal v_etotal_ev pe ke temp
dump 		snap_final all cfg 1 ./${density}/final.config.*.cfg mass type xs ys zs type x y z vx vy vz c_erad c_sp c_ch
dump_modify snap_final element I E_UP E_DOWN

run 0

