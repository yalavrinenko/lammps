variable	sname index velocity
log		${sname}.spe.log

units 		real
newton		on
boundary        m m m
processors      1 * *


atom_style	wavepacket

#START INIT SECTION

region          box block -8 8 -8 8 -8 8
create_box      2 box
create_atoms    1 random 32 24 box
create_atoms	2 random 32 42 box

mass            1 1.000794
mass			2 0.000544616997098749

set 	type 1 charge 1
set 	type 2 charge -1
set 	type 1 spin/wpmd 0
set 	type 2 spin/wpmd 1
set     type 2 eradius 0.86

group ion type 1
group electron type 2

velocity        ion create 10000 87287 dist gaussian
velocity        electron create 5000 87287 dist gaussian

#END INIT SECTION

pair_style      awpmd/cut -1. hartree ermscale 0.99 free flex_press
pair_coeff 	    * *

fix		w1 all wall/awpmd  0.861554971715096 -1 10

timestep        0.001

comm_modify	vel yes

compute         energies all pair awpmd/cut
variable 		etotal_ev equal etotal/627.509474*27.211386

compute         kinetik all ke

compute			ke_ion ion temp
compute			ke_el  electron temp

variable        mc_eng equal c_energies+c_kinetik-c_ke_el
fix             mc all wpmc/awpmd mc_eng 10000 ev

variable        accept equal f_mc[1]
variable        mc_energy equal f_mc[2]
variable        step_energy equal f_mc[3]

compute         all_temp all temp
fix 		ave all ave/time 1 1 1 v_etotal_ev c_kinetik c_ke_ion c_ke_el c_all_temp v_accept v_mc_eng file ave_mc.dat off 1

thermo          1
thermo_modify	norm yes
thermo_style    custom step v_etotal_ev pe ke c_ke_ion c_ke_el temp v_accept v_mc_energy v_step_energy

compute		erad all property/atom eradius
compute		sp   all property/atom spin
compute		ch   all property/atom q

dump 		snap all cfg 100 ./dumps/dump.config.*.cfg mass type xs ys zs type x y z vx vy vz c_erad c_sp c_ch
dump_modify snap element I E

run 		10000

unfix ave
unfix mc

thermo_style    custom step etotal v_etotal_ev c_energies c_kinetik pe ke temp
dump 		snap_final all cfg 1 final.config.*.cfg mass type xs ys zs type x y z vx vy vz c_erad c_sp c_ch
dump_modify snap_final element I E

run 0

unfix w1
